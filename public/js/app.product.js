(function(){!function(){"use strict";var a;return null==window.myapp&&(window.myapp={}),a=window.myapp,a.model={},a.collection={},a.view={main:{},sub:{}},a.util={}}()}).call(this),function(){(function(){"use strict";return myapp.util.CacheSync=function(){function a(){}return a.sync=function(a,b,c){var d,e,f;return c.error=function(){return window.location="#/error/"},f=function(d){return null!=d&&(c.success=d),Backbone.sync(a,b,c)},null==b.storage?f():(e=c.success,"delete"===a?f(function(a){return b.storage.remove(),e(a)}):"read"===a&&(d=b.storage.get(),null!=d)?e(d):f(function(c){return b.set(c),b.storage.set(c,a),e(c)}))},a}()}).call(this)}.call(this),function(){!function(){"use strict";var a;return a=sessionStorage,myapp.util.Storage={get:function(b){return a.getItem(b)},set:function(b,c){return a.setItem(b,c)},remove:function(b){return a.removeItem(b)},clear:function(){return a.clear()}}}()}.call(this),function(){!function(){"use strict";return myapp.Template=function(){function a(){var a,b,c,d,e,f,g;f=this.helper;for(b in f)a=f[b],Handlebars.registerHelper(b,a);for(g=this.particles,d=0,e=g.length;e>d;d++)c=g[d],Handlebars.registerPartial(c,myapp.JST["particle/"+c])}return a.prototype.get=function(a){return myapp.JST[a]},a.prototype.helper={upperCase:function(a){return a.toUpperCase()}},a.prototype.particles=["user"],a}()}()}.call(this),function(){(function(a,b,c){"use strict";return myapp.Router=Backbone.Router.extend({routes:{"":"top","my/":"my","friends/":"friends"},start:function(){return Backbone.history.start()},top:function(){return(new b.sub.Top).render(),(new b.main.Top).render()},my:function(){var c;return c=new a.User({id:1}),c.fetch({success:function(){return(new b.main.Default).show(c),(new b.sub.My).show(c)}})},friends:function(){var d;return d=new c.Users,d.fetch({success:function(){var c;return(new b.sub.Friends).show(d),c=new a.User({id:1}),c.fetch({success:function(){return(new b.main.Default).show(c)}})}})}})}).call(this,myapp.model,myapp.view,myapp.collection)}.call(this),function(){(function(a){"use strict";var b;return b=function(){function b(){this.template=new myapp.Template,this.router=new myapp.Router}return b.prototype.setupAjax=function(){return $.ajaxSettings.timeout=5e3,$.ajaxSettings.cache=!1,$.ajaxSettings.xhr=function(){var a;return a=new XMLHttpRequest}},b.prototype.start=function(){return a.Storage.clear(),this.setupAjax(),this.router.start()},b}(),myapp.app=new b}).call(this,myapp.util)}.call(this),function(){(function(a,b){"use strict";var c;return a.Base=Backbone.Model.extend({storage:null,sync:b.CacheSync.sync,createStorage:function(a){return this.storage=new c(a)}}),c=function(){function a(a){this.key=a}return a.prototype.get=function(){var a;return a=b.Storage.get(this.key),null!=a?JSON.parse(a):void 0},a.prototype.set=function(a){return b.Storage.set(this.key,JSON.stringify(a))},a.prototype.remove=function(){return b.Storage.remove(this.key)},a}()}).call(this,myapp.model,myapp.util)}.call(this),function(){(function(a){"use strict";return a.User=a.Base.extend({urlRoot:"/users/",initialize:function(a){return this.createStorage("model:user:"+a.id),this.name=a.name}})}).call(this,myapp.model)}.call(this),function(){(function(a,b,c){"use strict";var d;return b.Base=Backbone.Collection.extend({storage:null,sync:c.CacheSync.sync,model:a.Base,createStorage:function(a){return this.storage=new d(a,this.model)}}),d=function(){function b(a,b){this.key=a,this.model=b}return b.prototype.get=function(){var b,d,e,f,g,h;if(f=c.Storage.get(this.key),null!=f){for(d=[],f=JSON.parse(f),g=0,h=f.length;h>g;g++){if(e=f[g],a=new this.model({id:e}),b=a.storage.get(),null==b)return;d.push(b)}return d}},b.prototype.set=function(b,d){var e,f,g,h;for(f=[],g=0,h=b.length;h>g;g++)e=b[g],f.push(e.id),a=new this.model({id:e.id}),a.storage.set(e,d);return c.Storage.set(this.key,JSON.stringify(f))},b.prototype.remove=function(){var b,d,e,f,g;for(d=c.Storage.get(this.key),c.Storage.remove(this.key),g=[],e=0,f=d.length;f>e;e++)b=d[e],a=new this.model({id:b}),g.push(a.storage.remove());return g},b}()}).call(this,myapp.model,myapp.collection,myapp.util)}.call(this),function(){(function(a,b){"use strict";return b.Users=b.Base.extend({url:"/users/",model:a.User,initialize:function(){return this.createStorage("collection:users",this.model)}})}).call(this,myapp.model,myapp.collection)}.call(this),function(){(function(a){"use strict";return a.Base=Backbone.View.extend({render:function(a){return this.$el.html(this.tmpl(a))}})}).call(this,myapp.view)}.call(this),function(){(function(a){"use strict";return a.MainView=a.Base.extend({el:$("#mainview")})}).call(this,myapp.view)}.call(this),function(){(function(a){"use strict";return a.SubView=a.Base.extend({el:$("#subview")})}).call(this,myapp.view)}.call(this),function(){(function(a,b,c){"use strict";return b.Default=a.extend({tmpl:c.template.get("main/default"),show:function(a){return this.render({user:a.toJSON()})}})}).call(this,myapp.view.MainView,myapp.view.main,myapp.app)}.call(this),function(){(function(a,b,c){"use strict";return b.Top=a.extend({tmpl:c.template.get("main/top")})}).call(this,myapp.view.MainView,myapp.view.main,myapp.app)}.call(this),function(){(function(a,b,c){"use strict";return b.Friends=a.extend({tmpl:c.template.get("sub/friends"),show:function(a){return this.render({friends:a.toJSON()})}})}).call(this,myapp.view.SubView,myapp.view.sub,myapp.app)}.call(this),function(){(function(a,b,c){"use strict";return b.My=a.extend({tmpl:c.template.get("sub/my"),show:function(a){return this.render({user:a.toJSON()})}})}).call(this,myapp.view.SubView,myapp.view.sub,myapp.app)}.call(this),function(){(function(a,b,c){"use strict";return b.Top=a.extend({tmpl:c.template.get("sub/top")})}).call(this,myapp.view.SubView,myapp.view.sub,myapp.app)}.call(this),function(){!function(){"use strict";return myapp.app.start()}()}.call(this);